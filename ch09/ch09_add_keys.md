
[TOC]



# 补充题解 - 《经典》- 第 9 章动态规划初步

## 习题 9-7 Locker, Tianjin 2012, UVa1631

记初始数字序列为S[0,N)，目标序列为T[0,N)

每次转动可以选择选择相邻的1到3个。那么从左到右决策每一位时同时考虑相关的3位，具体来说设$D(i,d_0,d_1,d_2)$为$[i,N)$区间的每一位还未考虑，(i, i+1, i+2)三位上的数字分别是$d_0,d_1,d_2$，还需要的最少转动次数。

则状态转移方法如下:

1. $i = N-1$时，$D = min((d_0 - T_{N-1} + 10) \mod 10, (T_{N-1} - d_0 + 10) \mod 10)$，其实就是看看把$d_0$转动到$T_{N-1}$的上下两个方向哪种转动次数更小。
2. $d_0 = T_i $时，$D = D(i+1, d_1, d_2, S_{i+3})$。
3. 考虑往T上转k = $(T_i -d_0 + 10) \mod 10$次，则i+1, i+2位往上转的次数$k_1, k_2$就是满足$k\geq k_1 \geq k_2 \geq 0$的所有情况，针对每种情况 $D(i, d_0, d_1, d_2) = min(D(i, d_0, d_1, d_2), k + D(i+1, up(d_1, k_1), up(d_2, k_2)))$。其中up(a,b)表示数字a朝上转b得到的数字：$(a+b) \mod 10$。
4. T往下转k的情况同理。

则所求结果就是：$D(0, S_0, S_1, S_2 )$。

### 习题 9- 22 俄罗斯 套 娃（ Matryoshka, ACM/ ICPC World Finals 2013, UVa1579） 

桌上 有 n（ n ≤ 500） 个 套 娃 排成 一行， 你的 任务 是把 它们 套 成 若干个 套 娃 组， 使得 每个 套 娃 组 内 的 套 娃 编号 恰好 是 从 1 开始 的 连续 编号。 操作 规则 如下： 只能 把 小的 套在 大的 里面， 大小 相等 的 套 娃 相互 不能 套。 每次 只能 把 两个 相邻 的 套 娃 组 合并 成 一个 套 娃 组。 一旦 有 两个 套 娃 属于 同一个 组， 它们 永远 都 属于 同一个 组（ 只有 与 相邻 组 合并 的 过程 中会 临时 拆散）。 执行 合并 操作 的 前后， 所有 套 娃 都是 关闭 的。 为了 合并 两个 套 娃 组， 你 需要 交替 地 把 一些 套 娃 打开、 重新 套 起来、 关闭。 例如， 为了 合并[ 1, 2, 6] 和[ 4]， 需要 打开 套 娃 6 和 4； 为了 合并[ 1, 2, 5] 和[ 3, 4]， 需要 打开 套 娃 5, 4, 3（ 只有 先 打开 4 才能 打开 3）。 要求 打开/ 关闭 的 总 次数 最少。 无解 输出 impossible。 例如，“ 1 2 3 2 4 1 3” 需要 打开 7 次。

【分析】

如果问题有解，最终完成之后，一定是把整个区间切割成多个子区间，然后分别套成套娃组。每个子区间一定是由1~L的前L个正整数组成，我们称这样的区间是OK的，其中L是区间的长度。所以不难想到如下的状态转移方程：
$$
D_i=min\{D_j + S_{i, j}\}, [i,j)是OK的。
$$
其中$D_i$表示将[i,n)区间套成套娃组所需的最小次数，所求结果就是$D_0$，边界条件是$D_n=0$。初始所有$D_i= \infty $

下面考虑$S_{i,j}$，$S_{i,j}$表示将[i,j)区间套成一组所需要的最小次数。[i,j)区间不一定是OK的。下面我们来考虑计算$S_{i,j}, i < j$。

不难想到其状态转移方程，$S_{i,j}=min \{S_{i,k}+S_{k,j}+C_{i,k,j}\}, i<k<j$。其中$C_{i,k,j}$表示将[i,k)和[k,j)两个区间各自形成的套娃组，打开重新套起来形成一个新的套娃组所需要的操作次数。

怎么求$C_{i,k,j}$呢，举例来说，考虑[1,2,5], [3,4]这两个子区间，3,4,5三个都是要打开然后再关上的，那么不难总结出一般规律，考虑同在一个子区间中的最小的a个数字，则操作次数为$C_{i,k,j} = i-j-a$。

具体来说，每个区间是否OK可以提前预处理出来，时间复杂度为$O(n^2)$。计算$S_{i,j}$的复杂度为$O((i-j)^2)$。总体的时间复杂度为$O(n^3)$。




















